<div class="autocomplete-container">
  <label *ngIf="label" class="autocomplete-label">{{ label }}</label>
  
  <div class="input-wrapper" [class.focused]="isFocused" [class.has-value]="selectedValue || inputValue">
    <input
      #inputElement
      type="text"
      class="autocomplete-input"
      [placeholder]="placeholder"
      [(ngModel)]="inputValue"
      (input)="onInputChange($event)"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (keydown)="onKeyDown($event)"
      autocomplete="off"
    />
    
    <div class="input-icons">
      <!-- <i class="search-icon" *ngIf="!isLoading && !selectedValue">ğŸ”</i> -->
      <!-- <i class="loading-icon" *ngIf="isLoading">âŸ³</i> -->
      <i class="clear-icon" *ngIf="selectedValue || inputValue" (click)="clearSelection()">âœ•</i>
    </div>
  </div>

  <div 
    class="dropdown-menu" 
    *ngIf="showDropdown && (filteredOptions.length > 0 || isLoading || noResultsFound)"
    [class.show]="showDropdown"
  >
    <!-- Loading state -->
    <div class="dropdown-item loading-item" *ngIf="isLoading">
      <i class="loading-spinner">âŸ³</i>
      <span>{{ optionsLoaded ? 'Filtrando orientadores...' : 'Carregando orientadores...' }}</span>
    </div>

    <!-- No results -->
    <div class="dropdown-item no-results" *ngIf="noResultsFound && !isLoading">
      <i class="no-results-icon">ğŸ”</i>
      <span>Nenhum orientador encontrado</span>
    </div>

    <!-- Options -->
    <div 
      class="dropdown-item" 
      *ngFor="let option of filteredOptions; let i = index"
      [class.highlighted]="i === highlightedIndex"
      (click)="selectOption(option)"
      (mouseenter)="highlightedIndex = i"
    >
      <div class="option-content">
        <span class="option-name" [innerHTML]="highlightMatch(option)"></span>
      </div>
    </div>
  </div>

  <!-- Error message -->
  <div class="error-message" *ngIf="errorMessage">
    <i class="error-icon">âš ï¸</i>
    <span>{{ errorMessage }}</span>
  </div>
</div>